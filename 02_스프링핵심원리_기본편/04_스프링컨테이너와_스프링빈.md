# ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ ìŠ¤í”„ë§ ë¹ˆ

## ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±

```java
//ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
```

- `ApplicationContext` (ì¸í„°í˜ì´ìŠ¤) - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ
    - new `AnnotationConfigApplicationContext`(AppConfig.class);
    - ì´ í´ë˜ìŠ¤ëŠ” `ApplicationContext` ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ì²´ì´ë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” XMLì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆê³ , ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ìë°” ì„¤ì • í´ë˜ìŠ¤ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
  (ì§ì „ì— AppConfig ë¥¼ ì‚¬ìš©í–ˆë˜ ë°©ì‹ì´ ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ìë°” ì„¤ì • í´ë˜ìŠ¤ë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ë§Œë“ 
  ê²ƒì´ë‹¤.)


>ğŸ’¡ ë” ì •í™•íˆëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ë¶€ë¥¼ ë•Œ `BeanFactory` , `ApplicationContext` ë¡œ êµ¬ë¶„í•´ì„œ
>ì´ì•¼ê¸°í•œë‹¤. 
>`BeanFactory` ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ `ApplicationContext` ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ í•œë‹¤.
>ìµœìƒìœ„ê°€ `BeanFactory` ì´ê³  ê·¸ ë°‘ì— `ApplicationContext`ê°€ ìˆìŒ

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±

   ![Untitled](./img/Lecture4/Untitled.png)

2. ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡

   ![Untitled](./img/Lecture4/Untitled%201.png)

    - `@Bean` ë¶™ì€ê±° ì£„ë‹¤ í˜¸ì¶œ
    - beanì˜ ì´ë¦„ì€ ì£¼ë¡œ ë©”ì†Œë“œ ëª…ì¸ë° ì§ì ‘ ë¶€ì—¬ë„ ê°€ëŠ¥ (`@Bean(name="memberService2")`)
    - beanì˜ ì´ë¦„ì€ uniqueí•´ì•¼í•¨
        - ì¤‘ë³µë˜ë©´ ë‹¤ë¥¸ ë¹ˆì´ ë¬´ì‹œë˜ê±°ë‚˜, ê¸°ì¡´ ë¹ˆì„ ë®ì–´ë²„ë¦¬ê±°ë‚˜ ì„¤ì •ì— ë”°ë¼ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
        - ìµœê·¼ì—ëŠ” ì¶©ëŒë‚˜ë©´ ê²½ê³ ë‚ ë¦¼
        - ì• ë§¤í•œê±´ í•˜ì§€ë§ˆì„¸ìš”
    - return ë°˜í™˜í•˜ëŠ” ê²ƒì„ ë¹ˆ ê°ì²´ë¡œ ë“±ë¡
3. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì¤€ë¹„

   ![Untitled](./img/Lecture4/Untitled%202.png)

4. ìŠ¤í”„ë§ ë¹ˆ ì˜ì¡´ê´€ê³„ ì„¤ì • - ì™„ë£Œ

   ![Untitled](./img/Lecture4/Untitled%203.png)

    - ë™ì ì¸ ì˜ì¡´ê´€ê³„ (ê°ì²´-ì¸ìŠ¤í„´ìŠ¤ ì˜ì¡´ê´€ê³„)


>ğŸ’¡ **ìŠ¤í”„ë§ìœ¼ë¡œ ì˜ì¡´ê´€ê³„ ì£¼ì… vs ìë°”ë¡œ ì˜ì¡´ê´€ê³„ ì£¼ì…**
>- ìŠ¤í”„ë§ì€ ë¹ˆì„ ìƒì„±í•˜ê³  ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë‹¨ê³„ê°€ ë‚˜ë‰˜ì–´ì ¸ìˆìŒ
>- ìë°” ì½”ë“œë¡œ ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ë©´ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ì˜ì¡´ê´€ê³„ ì£¼ì…ë„ í•œë²ˆì— ì²˜ë¦¬ë¨

## ì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì¡°íšŒ

```java
@Test
    @DisplayName("ëª¨ë“  ë¹ˆ ì¶œë ¥í•˜ê¸°")
    void findAllBean(){
        String[] beanDefinitionNames = ac.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            Object bean = ac.getBean(beanDefinitionName);
            System.out.println("name = " + beanDefinitionName + " object = " + bean);
        }
    }

    @Test
    @DisplayName("ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹ˆ ì¶œë ¥í•˜ê¸°")
    void findApplicationBean(){
        String[] beanDefinitionNames = ac.getBeanDefinitionNames();
        for (String beanDefinitionName : beanDefinitionNames) {
            BeanDefinition beanDefinition = ac.getBeanDefinition(beanDefinitionName);//beanì— ëŒ€í•œ ë©”íƒ€ë°ì´í„° ì •ë³´

            // ROLE_APPLICATION : ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì •ì˜í•œ ë¹ˆ
            // ROLE_INFRASTRUCTURE : ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ
            if(beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION){
                Object bean = ac.getBean(beanDefinitionName);
                System.out.println("name = " + beanDefinitionName + " object = " + bean);
            }
        }
    }
```

- `ac.getBeanDefinitionNames()` : ìŠ¤í”„ë§ì— ë“±ë¡ëœ ëª¨ë“  ë¹ˆ ì´ë¦„ì„ ì¡°íšŒí•œë‹¤.
- `ac.getBean()` : ë¹ˆ ì´ë¦„ìœ¼ë¡œ ë¹ˆ ê°ì²´(ì¸ìŠ¤í„´ìŠ¤)ë¥¼ ì¡°íšŒí•œë‹¤.
- `ac.getRole()`
    - ROLE_APPLICATION : ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ìê°€ ì •ì˜í•œ ë¹ˆ

        ```java
        name = org.springframework.context.annotation.internalConfigurationAnnotationProcessor object = org.springframework.context.annotation.ConfigurationClassPostProcessor@395b56bb
        name = org.springframework.context.annotation.internalAutowiredAnnotationProcessor object = org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor@256f8274
        name = org.springframework.context.annotation.internalCommonAnnotationProcessor object = org.springframework.context.annotation.CommonAnnotationBeanPostProcessor@68044f4
        name = org.springframework.context.event.internalEventListenerProcessor object = org.springframework.context.event.EventListenerMethodProcessor@52d239ba
        name = org.springframework.context.event.internalEventListenerFactory object = org.springframework.context.event.DefaultEventListenerFactory@315f43
        ```

    - ROLE_INFRASTRUCTURE : ìŠ¤í”„ë§ì´ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ

        ```java
        name = appConfig object = hello.core.AppConfig$$EnhancerBySpringCGLIB$$283060ad@68fa0ba8
        name = memberService object = hello.core.member.MemberServiceImpl@6c5945a7
        name = memberRepository object = hello.core.member.MemoryMemberRepository@2f05be7f
        name = orderService object = hello.core.order.OrderServiceImpl@640f11a1
        name = discountPolicy object = hello.core.discount.RateDiscountPolicy@5c10f1c3
        ```


## ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ê¸°ë³¸

- `ac.getBean(ë¹ˆì´ë¦„, íƒ€ì…)`
- `ac.getBean(íƒ€ì…)`

## ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ë™ì¼í•œ íƒ€ì…ì´ ë‘˜ ì´ìƒ

- `ac.getBeansOfType()`

## ìŠ¤í”„ë§ ë¹ˆ ì¡°íšŒ - ìƒì†ê´€ê³„

- ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒí•˜ë©´ ìì‹ íƒ€ì…ë„ í•¨ê»˜ ì¡°íšŒ

![Untitled](./img/Lecture4/Untitled%204.png)

> ì‹¤ì œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ì¤‘ ìŠ¤í”„ë§ ë¹ˆì„ ë³¼ ì¼ì€ ì—†ì§€ë§Œ ë‚˜ì¤‘ì— ìë™ ì˜ì¡´ê´€ê³„ ì£¼ì… ì‹œ ì˜ í•´ê²°í•  ìˆ˜ ìˆìŒ!
>

## BeanFactoryì™€ ApplicationContext

ì¸í„°í˜ì´ìŠ¤ë¼ë¦¬ ìƒì†

![Untitled](./img/Lecture4/Untitled%205.png)

- BeanFactory

  ![Untitled](./img/Lecture4/Untitled%206.png)

    - ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ìµœìƒìœ„ ì¸í„°í˜ì´ìŠ¤ì´ë©° ìŠ¤í”„ë§ ë¹ˆì„ ê´€ë¦¬í•˜ê³  ì¡°íšŒí•¨
    - `getBean()` ì„ ì œê³µ
- ApplicationContext

  ![Untitled](./img/Lecture4/Untitled%207.png)

    - BeanFactory ê¸°ëŠ¥ì„ ëª¨ë‘ ìƒì†ë°›ì•„ì„œ ì œê³µí•œë‹¤. (BeanFactory í”ŒëŸ¬ìŠ¤ ì•ŒíŒŒ)
    - ë¹ˆì„ ê´€ë¦¬í•˜ê³  ê²€ìƒ‰í•˜ëŠ” ê¸°ëŠ¥ì„ BeanFactoryê°€ ì œê³µí•´ì£¼ëŠ”ë°, ê·¸ëŸ¬ë©´ ë‘˜ì˜ ì°¨ì´ê°€ ë­˜ê¹Œ?
    - ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ë•ŒëŠ” ë¹ˆì€ ê´€ë¦¬í•˜ê³  ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ì€ ë¬¼ë¡ ì´ê³ , ìˆ˜ ë§ì€ ë¶€ê°€ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤

  ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™

  ![Untitled](./img/Lecture4/Untitled%208.png)

    - ë©”ì‹œì§€ì†ŒìŠ¤ë¥¼ í™œìš©í•œ êµ­ì œí™” ê¸°ëŠ¥
        - ì˜ˆë¥¼ ë“¤ì–´ì„œ í•œêµ­ì—ì„œ ë“¤ì–´ì˜¤ë©´ í•œêµ­ì–´ë¡œ, ì˜ì–´ê¶Œì—ì„œ ë“¤ì–´ì˜¤ë©´ ì˜ì–´ë¡œ ì¶œë ¥
    - í™˜ê²½ë³€ìˆ˜
        - ë¡œì»¬, ê°œë°œ, ìš´ì˜ë“±ì„ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬
    - ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë²¤íŠ¸
        - ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•˜ê³  êµ¬ë…í•˜ëŠ” ëª¨ë¸ì„ í¸ë¦¬í•˜ê²Œ ì§€ì›
    - í¸ë¦¬í•œ ë¦¬ì†ŒìŠ¤ ì¡°íšŒ
        - íŒŒì¼, í´ë˜ìŠ¤íŒ¨ìŠ¤, ì™¸ë¶€ ë“±ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒ


>ğŸ’¡ - ApplicationContextëŠ” BeanFactoryì˜ ê¸°ëŠ¥ì„ ìƒì†ë°›ëŠ”ë‹¤.
>- ApplicationContextëŠ” ë¹ˆ ê´€ë¦¬ê¸°ëŠ¥ + í¸ë¦¬í•œ ë¶€ê°€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
>- BeanFactoryë¥¼ ì§ì ‘ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤. ë¶€ê°€ê¸°ëŠ¥ì´ í¬í•¨ëœ ApplicationContextë¥¼ ì‚¬ìš©í•œë‹¤.
>- BeanFactoryë‚˜ ApplicationContextë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ í•œë‹¤.

## ë‹¤ì–‘í•œ ì„¤ì • í˜•ì‹ ì§€ì› - ìë°” ì½”ë“œ, XML

![Untitled](./img/Lecture4/Untitled%209.png)

ë°©ê¸ˆê¹Œì§€ í–ˆë˜ ê±´ ì²«ë²ˆì§¸êº¼!

### ì–´ë…¸í…Œì´ì…˜ ê¸°ë°˜ ìë°” ì½”ë“œ ì„¤ì • ì‚¬ìš©

- `new AnnotationConfigApplicationContext(AppConfig.class)`
- `AnnotationConfigApplicationContext`

## XML ì„¤ì • ì‚¬ìš©

- ì»´íŒŒì¼ ì—†ì´ ì„¤ì • ì •ë³´ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒÃŸ

## ìŠ¤í”„ë§ ë¹ˆ ì„¤ì • ë©”íƒ€ ì •ë³´ - BeanDefinition

![Untitled](./img/Lecture4/Untitled%2012.png)

- `BeanDefinition` : ë¹ˆ ì„¤ì • ë©”íƒ€ì •ë³´
    - `@Bean`, `<bean>` ë‹¹ ê°ê° í•˜ë‚˜ì”© ë©”íƒ€ ì •ë³´ê°€ ìƒì„±ë¨
    - ì¶”ìƒí™”ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì„¤ê³„ë¨


![Untitled](./img/Lecture4/Untitled%2013.png)

- `AnnotationConfigApplicationContext` ëŠ” `AnnotatedBeanDefinitionReader` ë¥¼ ì‚¬ìš©í•´ì„œ
  AppConfig.class ë¥¼ ì½ê³  `BeanDefinition` ì„ ìƒì„±í•œë‹¤.

- `GenericXmlApplicationContext` ëŠ” `XmlBeanDefinitionReader` ë¥¼ ì‚¬ìš©í•´ì„œ appConfig.xml ì„¤ì • ì •ë³´ë¥¼ ì½ê³  `BeanDefinition` ì„ ìƒì„±í•œë‹¤.

- `ac.getBeanDefinitionNames()`
- `ac.getBeanDefinition(beanDefinitionName)`

- `BeanDefinition`ì„ ì§ì ‘ ìƒì„±í•´ì„œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡í•  ìˆ˜ ë„ ìˆë‹¤. í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œ `BeanDefinition`ì„ ì§ì ‘ ì •ì˜í•˜ê±°ë‚˜ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤.
- ìŠ¤í”„ë§ì´ ë‹¤ì–‘í•œ í˜•íƒœì˜ ì„¤ì • ì •ë³´ë¥¼ `BeanDefinition`ìœ¼ë¡œ ì¶”ìƒí™”í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ì •ë„ë§Œ ì´í•´í•˜ë©´ ëœë‹¤
- ê°€ë” ìŠ¤í”„ë§ ì½”ë“œë‚˜ ìŠ¤í”„ë§ ê´€ë ¨ ì˜¤í”ˆ ì†ŒìŠ¤ì˜ ì½”ë“œë¥¼ ë³¼ ë•Œ, `BeanDefinition` ì´ë¼ëŠ” ê²ƒì´ ë³´ì¼ ë•Œê°€ ìˆë‹¤. ì´ë•Œ ì´ëŸ¬í•œ ë©”ì»¤ë‹ˆì¦˜ì„ ë– ì˜¬ë¦¬ë©´ ëœë‹¤.

```
beanDefinitionName = appConfig beanDefinition =  Generic bean: class [hello.core.AppConfig$$EnhancerBySpringCGLIB$$61c69356]; scope=singleton; abstract=false; lazyInit=null; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null
beanDefinitionName = memberService beanDefinition =  Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=appConfig; factoryMethodName=memberService; initMethodName=null; destroyMethodName=(inferred); defined in hello.core.AppConfig
beanDefinitionName = memberRepository beanDefinition =  Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=appConfig; factoryMethodName=memberRepository; initMethodName=null; destroyMethodName=(inferred); defined in hello.core.AppConfig
beanDefinitionName = orderService beanDefinition =  Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=appConfig; factoryMethodName=orderService; initMethodName=null; destroyMethodName=(inferred); defined in hello.core.AppConfig
beanDefinitionName = discountPolicy beanDefinition =  Root bean: class [null]; scope=; abstract=false; lazyInit=null; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=appConfig; factoryMethodName=discountPolicy; initMethodName=null; destroyMethodName=(inferred); defined in hello.core.AppConfig
```

```
beanDefinitionName = memberService beanDefinition =  Generic bean: class [hello.core.member.MemberServiceImpl]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [appConfig.xml]
beanDefinitionName = memberRepository beanDefinition =  Generic bean: class [hello.core.member.MemoryMemberRepository]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [appConfig.xml]
beanDefinitionName = orderService beanDefinition =  Generic bean: class [hello.core.order.OrderServiceImpl]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [appConfig.xml]
beanDefinitionName = discountPolicy beanDefinition =  Generic bean: class [hello.core.discount.RateDiscountPolicy]; scope=; abstract=false; lazyInit=false; autowireMode=0; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=null; factoryMethodName=null; initMethodName=null; destroyMethodName=null; defined in class path resource [appConfig.xml]
```

ì§ì ‘ ë¹ˆ ì„ ì–¸

íŒ©í† ë¦¬ ë©”ì†Œë“œ ì‚¬ìš© (appConfigê°€ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ ì œê³µ)