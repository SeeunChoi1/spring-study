# 1.2 DAO의 분리

## 1.2.1 관심사의 분리 (Separation of Concerns)

- 미래의 변화를 어떻게 대비할 것인가에 염두하여 객체를 설계해야함
- 절차적 vs 객체지향 vs 함수형
- 최소한의 작업으로 최대한의 확신을 줄 수 있는 설계

  ← 변경시 작업 최소화

  ← 분리와 확장이 고려된 설계

- 변경요청 예시 **→ 한 가지 관심사항에 집중되어있음**

**⇒ 관심이 같은 것끼리는 모으고, 관심이 다른 것은 따로 떨어져 있게 하는 것**

## 1.2.2 커넥션 만들기의 추출

UserDao의 add()에서 발견된 세 가지 관심사항  
1. DB 연결을 위한 커넥션 가져오기 (이건 심지어 다른 메소드에도 있음)
2. SQL문장을 담을 Statement 생성 및 실행 + 파라미터 바인딩  
3. 작업 종류 후 Statement, Connection 오브젝트를 닫아서 리소스 관리  
+) 예외상황 처리가 안되어있음

- 중복 코드의 메소드 추출


위에서 방금한게 **메소드 추출 기법**을 사용한 **리팩토링**

## 1.2.3 DB 커텍션 만들기의 독립

- 상속을 통한 확장

  ![Untitled](../img/Chap1/Untitled%202.png)

- 템플릿 메소드 패턴 (template method pattern)
    - 슈퍼클래스에 기본적인 로직의 흐름을 만들고 그 기능의 일부를 추상 메소드나 오버라이딩이 가능한 protected 메소드 등으로 만든 뒤 서브클래스에서 이런 메소드를 필요에 맞게 구현해서 사용
    - 스프링에서 애용되는 디자인 패턴
- 팩토리 메소드 패턴 (factory method pattern)

  ![Untitled](../img/Chap1/Untitled%204.png)

    - 서브클래스에서 구체적인 오브젝트 생성 방법을 결정하는 디자인 패턴

여기서 포인트는 상속구조를 통해 성격이 다른 관심사항을 분리한 코드를 만들어내고, 서로 영향을 덜 주도록 했는지를 이해하는 것!

> **디자인 패턴**
>: 설계시 특정 상황에서 자주 만나는 문제를 해결하기 위해 사용할 수 있는 재사용 가능한 솔루션
>- 주로 객체지향 설계에 관한 것이고, 대부분 객체 지향적 설계 원칙을 이용해 문제를 해결함
>- 크게 2가지의 확장성 추구 방법이 있다
>    1. 클래스 상속
>    2. 오브젝트 합성
>- 각 패턴의 핵심이 담긴 목적 또는 의도가 중요함
>- 패턴을 적용할 상황, 해결해야 할 문제, 솔루션의 구조와 각 요소의 역할과 함께 핵심 의도 파악이 필요
>

[템플릿 메소드 패턴](https://www.notion.so/e702d3e0a25e4515880a39e02ed9fe69)

[팩토리 메소드 패턴](https://www.notion.so/028d1a2f4e44485494803996314dd459)

상속을 사용했다는 단점이 있다. (그럼 어쩌라는거지?)

- 다중상속이 있었으면 어쩔래? (ㅇㅎ...)
- 단순히 커넥션 객체 불러오는걸 분리하기 위해 상속을 쓰면 다른 목적으로 상속을 적용하기 어려움
- 상속을 통한 상하위 클래스의 관계를 생각보다 밀접하다
    - 관심사가 달라서 나눠놨더니 상속도 긴밀한 결합임
    - 슈퍼클래스 내부 변경이 있을 때 서브클래스도 수정해야할 수 있음
- 커넥션 생성 코드를 다른 DAO에 적용할 수 없다
    - 매 DAO마다 중복되면 문제가 심각해짐